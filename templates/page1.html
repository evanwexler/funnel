{% extends "base.html" %}
{% block content %}
<nav class="nav" style="z-index:-1">
			<img class="logo" src={{url_for('static', filename='funnel-logo.svg')}}>

		</nav>
<div class="con">
		<div class="main">
			<div class="page1">
                          <div class="downarrow" style="height:200px"></div>
			<img class="mainlogo" src={{url_for('static', filename='funnel-logo.svg')}}>
		</div>
<div class="colourbar">
				<li style="background-color:#1F6D99"></li>
				<li style="background-color:#1C9B6E"></li>
				<li style="background-color:#95C020"></li>
				<li style="background-color:#F0C514"></li>
				<li style="background-color:#FD5203"></li>
				<li style="background-color:#CE3028"></li>
				<li style="background-color:#DC425C"></li>
				<li style="background-color:#974C99"></li>
				<li style="background-color:#4633A8"></li>
			</div>
<div class="col-xs-12">
	 	 <div class="center megaphone rotate"></div>
	 	 <div class="w trigger"></div>
	  <a class="nextpage" href='/3'></a>
		<div class="end"></div>
</div>
	</div>	
</div>
{% endblock %}

{% block scripts %}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.js"></script>
<script src={{url_for('static', filename='waypoints.js')}}></script>
<script>

var waypoint = new Waypoint({
    context: $("div.main"),
    element: $('div.w'),
    handler: function(direction) {
     if (direction == 'down') {
	$(".megaphone").removeClass("rotate").addClass("rotated")
}
    else {
	    $(".megaphone").removeClass("rotated").addClass("rotate")
    }
},
        offset: 'bottom-in-view',
        enabled: true
})

var cbwaypoint = new Waypoint({
    context: $("div.main"),
    element: $("div.colourbar"),
    handler: function(d) {
      if (d == 'down') {
      $("div.main").unbind('scroll', scrollFunc);
      $('nav.nav').css({'z-index':1});
        if ($('nav.nav').has('div.colourbar').length == 0) {
            $('nav.nav').append($('div.colourbar')[0].outerHTML)
            }
      }
      else {
      $("div.main").bind('scroll', scrollFunc)
      $('nav.nav').css({'z-index':-1})
          $('nav.nav div.colourbar').remove()
      }
    },
    offset: '100px',
    })

var page1height = $("div.page1").innerHeight();
var prevscroll = 0;
var direction = "down"

scrollFunc = function() {
    scrolltop = $(this).scrollTop()
    $("img.mainlogo").height(300-scrolltop)
    $("div.downarrow").height(200-scrolltop)
    $("div.page1").height(page1height-scrolltop)
    $("div.page1").css({'margin-top':scrolltop})
}

loadNextPage = function() {
    if($(this).scrollTop() + $(this).innerHeight() >= $(this)[0].scrollHeight) {
    url = $('a.nextpage:last').attr('href')
    x = $.get(url, function(data) {
      content = $('div.main', data)[0]
      $("div.main").append(content.innerHTML)
        })
    }
}

$('div.main').bind('scroll', scrollFunc)
$('div.main').bind('scroll', loadNextPage)
</script>
{% endblock %}
